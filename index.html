<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Infine8 Pages</title>
  <style>
    /* ... (same CSS as before, for brevity) ... */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: radial-gradient(circle at 20% 30%, #ff7ede, #ffe15f, #00d4ff, #7efff5, #ff9f43);
      background-size: 200% 200%;
      animation: pulse 15s ease infinite;
      color: #0f1020;
      min-height: 100vh;
      margin: 0; padding: 0; box-sizing: border-box;
    }
    /* Add rest of your styles here (hamburger, container, sections, buttons) */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">Infine8 Pages</div>
      <nav>
        <div class="hamburger" onclick="toggleMenu()">
          <div></div><div></div><div></div>
        </div>
        <div class="menu" id="menu">
          <a href="#codes">Redeem Code</a>
          <a href="#workout">Workout</a>
          <a href="#mystats">My Stats</a>
          <a href="#share">Share a Moment</a>
          <a href="#join">Join Infine8 Team</a>
          <a href="#bug">Report a Bug</a>
          <a href="#newsurprise">New Surprise</a>
        </div>
      </nav>
    </header>

    <section id="codes" class="section">
      <h2>Redeem Code</h2>
      <p class="small">Enter the weekly code from the videos to unlock exclusive workout episodes and challenges.</p>
      <form id="codeForm">
        <input type="text" id="codeInput" placeholder="Enter code" required />
        <button class="btn" type="submit" style="width:160px;">Redeem</button>
        <p id="codeMessage" class="status"></p>
      </form>
    </section>

    <section id="workout" class="section">
      <h2>Workout</h2>
      <p class="small">Coming Soon...</p>
    </section>

    <section id="mystats" class="section">
      <h2>My Stats & Challenge Progress</h2>
      <p class="small">Enter your name, height (cm), starting weight (kg), and optional photo. After the challenge is done you can log your new weight to track progress.</p>
      
      <form id="profile-form">
        <input type="text" id="user-name" placeholder="Name" required />
        <input type="number" id="height" placeholder="Height (cm)" required min="50" />
        <input type="number" id="start-weight" placeholder="Starting Weight (kg)" required min="1" />
        <label>Profile Photo (optional):
          <input type="file" id="photo-input" accept="image/*" />
        </label>
        <div id="photo-preview"></div>
        <button class="btn" type="submit" style="width:160px;">Save Profile</button>
      </form>

      <div id="progress-section" style="display:none; margin-top:1rem;">
        <h3>Progress</h3>
        <p id="welcome-msg"></p>
        <p>Starting BMI: <span id="start-bmi"></span></p>
        <p>Current Weight: <span id="current-weight"></span> kg</p>
        <p>Current BMI: <span id="current-bmi"></span></p>
        <p>Weight Change: <span id="delta-weight"></span> kg</p>

        <div id="challenge-result-wrapper" style="margin-top:1rem;">
          <div id="challenge-coming-soon">
            <p><strong>Challenge Result:</strong> Coming soon. After the challenge, click below to log your new weight.</p>
            <button class="btn" id="enable-result" type="button" style="width:180px;">Log Challenge Result</button>
          </div>

          <form id="update-weight-form" style="margin-top:0.75rem; display:none;">
            <input type="number" id="new-weight" placeholder="New Weight (kg)" required min="1" />
            <button class="btn" type="submit" style="width:160px;">Update Result</button>
          </form>
        </div>

        <button class="btn" id="reset-stats" style="margin-top:10px; background:#ff6f61;">Reset</button>
      </div>
    </section>

    <section id="share" class="section">
      <h2>Share a Moment</h2>
      <p class="small">Send a photo or short video plus a description. It'll go straight to the email. Keep video under ~10MB or use a link if bigger.</p>
      <form id="share-form" action="https://formsubmit.co/burra.mohan.krishna@outlook.com" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="_subject" value="Share a Moment with Media" />
        <input type="text" name="name" placeholder="Your name" required />
        <textarea name="moment" placeholder="Describe the moment..." required></textarea>
        <label style="font-size:.8rem; margin-top:.5rem;">Upload photo or short video (optional, keep under ~10MB):
          <input type="file" name="attachment" accept="image/*,video/*" id="share-media-input" />
        </label>
        <div id="media-preview"></div>
        <button class="btn" type="submit" style="width:160px;">Send</button>
      </form>
    </section>

    <section id="join" class="section">
      <h2>Join Infine8 Team</h2>
      <p class="small">Want in? Drop your pitch here.</p>
      <form action="https://formsubmit.co/burra.mohan.krishna@outlook.com" method="POST">
        <input type="hidden" name="_subject" value="Team Application" />
        <input type="text" name="name" placeholder="Your name" required />
        <input type="email" name="email" placeholder="Your email" required />
        <textarea name="why" placeholder="Why you want to join" required></textarea>
        <button class="btn" type="submit">Apply</button>
      </form>
    </section>

    <section id="bug" class="section">
      <h2>Report a Bug</h2>
      <p class="small">Something's broken? Tell me what and where — it shoots to the email.</p>
      <form action="https://formsubmit.co/burra.mohan.krishna@outlook.com" method="POST">
        <input type="hidden" name="_subject" value="Bug Report" />
        <input type="text" name="name" placeholder="Your name" required />
        <textarea name="bug" placeholder="Describe the bug..." required></textarea>
        <button class="btn" type="submit">Report</button>
      </form>
    </section>

    <section id="newsurprise" class="section">
      <h2>New Surprise</h2>
      <p class="small">Coming at 100 subs. Stay locked in — big upgrade dropping when we hit the milestone.</p>
    </section>

    <footer class="footer">&copy; Infine8 | More updates coming soon</footer>
  </div>

  <script>
    // Hamburger toggle
    function toggleMenu() {
      document.getElementById('menu').classList.toggle('active');
    }
    document.addEventListener('click', (e) => {
      const menu = document.getElementById('menu');
      const ham = document.querySelector('.hamburger');
      if(!menu.contains(e.target) && !ham.contains(e.target)) menu.classList.remove('active');
    });

    // SHA-256 hash function
    async function sha256hex(str) {
      const encoder = new TextEncoder();
      const data = encoder.encode(str.toUpperCase());
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    const VALID_HASH = 'a098c2b15db6ef96263005d138d110e17825b245f1fe8bd067b185df3156f342'; // hash of INF8DROP1
    const STORAGE_CODE_KEY = 'infine8CodeUnlocked';

    const codeForm = document.getElementById('codeForm');
    const codeInput = document.getElementById('codeInput');
    const codeMessage = document.getElementById('codeMessage');

    async function checkCode(code) {
      const hash = await sha256hex(code);
      return hash === VALID_HASH;
    }

    codeForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const code = codeInput.value.trim();
      if (!code) return;
      codeMessage.textContent = 'Checking code...';
      if (await checkCode(code)) {
        localStorage.setItem(STORAGE_CODE_KEY, 'true');
        codeMessage.textContent = 'Code accepted! Content unlocked.';
        codeMessage.className = 'status success';
        codeInput.value = '';
        showWorkoutContent();
      } else {
        codeMessage.textContent = 'Invalid code, try again.';
        codeMessage.className = 'status error';
      }
    });

    // On load, check if unlocked
    window.addEventListener('load', () => {
      if (localStorage.getItem(STORAGE_CODE_KEY) === 'true') {
        showWorkoutContent();
      }
    });

    // Dummy workout content show function
    function showWorkoutContent() {
      const workout = document.getElementById('workoutContent');
      workout.innerHTML = `
        <p><strong>Unlocked Workout Episodes & Challenges!</strong></p>
        <ul>
          <li>Episode 1 - Full Body Warmup</li>
          <li>Episode 2 - Core Blast</li>
          <li>Episode 3 - HIIT Challenge</li>
          <li>Episode 4 - Flexibility Flow</li>
          <li>Episode 5 - Endurance Run</li>
        </ul>
      `;
    }

    // My Stats & Challenge logic
    const profileForm = document.getElementById('profile-form');
    const photoInput = document.getElementById('photo-input');
    const photoPreview = document.getElementById('photo-preview');
    const progressSection = document.getElementById('progress-section');
    const welcomeMsg = document.getElementById('welcome-msg');
    const startBMI = document.getElementById('start-bmi');
    const currentWeightSpan = document.getElementById('current-weight');
    const currentBMI = document.getElementById('current-bmi');
    const deltaWeight = document.getElementById('delta-weight');
    const enableResultBtn = document.getElementById('enable-result');
    const updateWeightForm = document.getElementById('update-weight-form');
    const newWeightInput = document.getElementById('new-weight');
    const resetStatsBtn = document.getElementById('reset-stats');

    let userData = null;

    function calcBMI(weight, heightCm) {
      const heightM = heightCm / 100;
      return (weight / (heightM * heightM)).toFixed(1);
    }

    function loadUserData() {
      const dataStr = localStorage.getItem('infine8UserStats');
      if (dataStr) {
        userData = JSON.parse(dataStr);
        return true;
      }
      return false;
    }

    function saveUserData() {
      localStorage.setItem('infine8UserStats', JSON.stringify(userData));
    }

    function updateProgressUI() {
      if (!userData) return;
      welcomeMsg.textContent = `Welcome, ${userData.name}!`;
      startBMI.textContent = calcBMI(userData.startWeight, userData.height);
      currentWeightSpan.textContent = userData.currentWeight || userData.startWeight;
      currentBMI.textContent = calcBMI(userData.currentWeight || userData.startWeight, userData.height);
      deltaWeight.textContent = ((userData.currentWeight || userData.startWeight) - userData.startWeight).toFixed(1);

      if(userData.photoData) {
        photoPreview.innerHTML = `<img src="${userData.photoData}" alt="Profile photo" style="max-width:150px; max-height:150px; border-radius:8px; margin-top:10px;">`;
      } else {
        photoPreview.innerHTML = '';
      }
      progressSection.style.display = 'block';
    }

    profileForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('user-name').value.trim();
      const height = Number(document.getElementById('height').value);
      const startWeight = Number(document.getElementById('start-weight').value);

      if (!name || height < 50 || startWeight < 1) {
        alert('Please fill all required fields correctly.');
        return;
      }

      userData = userData || {};
      userData.name = name;
      userData.height = height;
      userData.startWeight = startWeight;
      userData.currentWeight = userData.currentWeight || startWeight;

      saveUserData();
      updateProgressUI();
    });

    photoInput.addEventListener('change', () => {
      const file = photoInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        if (!userData) userData = {};
        userData.photoData = e.target.result;
        saveUserData();
        updateProgressUI();
      };
      reader.readAsDataURL(file);
    });

    enableResultBtn.addEventListener('click', () => {
      updateWeightForm.style.display = 'block';
      enableResultBtn.style.display = 'none';
    });

    updateWeightForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const newWeight = Number(newWeightInput.value);
      if (newWeight < 1) {
        alert('Enter a valid new weight.');
        return;
      }
      userData.currentWeight = newWeight;
      saveUserData();
      updateProgressUI();
      updateWeightForm.style.display = 'none';
      enableResultBtn.style.display = 'inline-block';
      newWeightInput.value = '';
    });

    resetStatsBtn.addEventListener('click', () => {
      if (confirm('Are you sure you want to reset your stats?')) {
        localStorage.removeItem('infine8UserStats');
        userData = null;
        progressSection.style.display = 'none';
        photoPreview.innerHTML = '';
        profileForm.reset();
      }
    });

    // On load, try to load stats if saved
    window.addEventListener('load', () => {
      if (loadUserData()) updateProgressUI();
    });

    // Share form media preview
    const shareMediaInput = document.getElementById('share-media-input');
    const mediaPreview = document.getElementById('media-preview');

    shareMediaInput.addEventListener('change', () => {
      mediaPreview.innerHTML = '';
      const file = shareMediaInput.files[0];
      if (!file) return;
      if (file.type.startsWith('image/')) {
        const img = document.createElement('img');
        img.style.maxWidth = '150px';
        img.style.borderRadius = '8px';
        img.src = URL.createObjectURL(file);
        mediaPreview.appendChild(img);
      } else if (file.type.startsWith('video/')) {
        const video = document.createElement('video');
        video.controls = true;
        video.style.maxWidth = '250px';
        video.src = URL.createObjectURL(file);
        mediaPreview.appendChild(video);
      }
    });
  </script>
</body>
</html>
